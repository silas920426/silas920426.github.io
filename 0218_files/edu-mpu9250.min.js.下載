!function(e){"undefined"==typeof exports?e(webduino||{}):module.exports=e}(function(e){"use strict";var s,t=e.Module,_=e.BoardEvent,a={ACCELEROMETER_MESSAGE:"a",GYROSCOPE_MESSAGE:"g",MAGNETOMETER_MESSAGE:"m",ANGLE_MESSAGE:"o",AZIMUTH_MESSAGE:"c"},h={START_DETECT:[240,4,96,2,247],STOP_DETECT:[240,4,96,3,247],START_ACC:[240,4,96,17,1,247],STOP_ACC:[240,4,96,17,0,247],START_GYR:[240,4,96,18,1,247],STOP_GYR:[240,4,96,18,0,247],START_MAG:[240,4,96,19,1,247],STOP_MAG:[240,4,96,19,0,247],START_ANG:[240,4,96,20,1,247],STOP_ANG:[240,4,96,20,0,247],START_AZI:[240,4,96,21,1,247],STOP_AZI:[240,4,96,21,0,247]};function n(e){t.call(this),this._board=e,this._detectTimeType=3,this._messageHandler=function(e){var s=e.message;if(96!=s[0])return;var t=function(e){if(96!=e[0])return"";for(var s=String.fromCharCode(e[1]+32)+" ",t=2;t<e.length;t++)s+=String.fromCharCode(e[t]);return s=s.trim().split(/\s+/)}(s),_=function(e,s){e.forEach(function(e){e.call(null,s[0],s[1],s[2],(new Date).getTime())})},a=s[1],h=t.slice(1,4);switch(console.log(h),a){case 2:console.log("Start mpu9250 detect...");break;case 3:console.log("Stop mpu9250 detect.");break;case 17:this._accVals=h,_(this._a_handlers,h);break;case 18:this._gyrVals=h,_(this._g_handlers,h);break;case 19:this._magVals=h,_(this._m_handlers,h);break;case 20:this._angVals=h,_(this._o_handlers,h);break;case 21:this._aziVals=h,_(this._c_handlers,h)}}.bind(this),this._startDetect=function(e,s){if("function"!=typeof s)return!1;switch(e){case a.ACCELEROMETER_MESSAGE:0===this._a_handlers.length&&this._board.send(h.START_ACC),this._a_handlers.push(s);break;case a.GYROSCOPE_MESSAGE:0===this._g_handlers.length&&this._board.send(h.START_GYR),this._g_handlers.push(s);break;case a.MAGNETOMETER_MESSAGE:0===this._m_handlers.length&&this._board.send(h.START_MAG),this._m_handlers.push(s);break;case a.ANGLE_MESSAGE:0===this._o_handlers.length&&this._board.send(h.START_ANG),this._o_handlers.push(s);break;case a.AZIMUTH_MESSAGE:0===this._c_handlers.length&&this._board.send(h.START_AZI),this._c_handlers.push(s);break;default:return!1}return!0}.bind(this),this._stopDetect=function(e,s){switch(e){case a.ACCELEROMETER_MESSAGE:var t=this._a_handlers.indexOf(s);this._a_handlers.splice(t,1),0===this._a_handlers.length&&this._board.send(h.STOP_ACC);break;case a.GYROSCOPE_MESSAGE:var t=this._g_handlers.indexOf(s);this._g_handlers.splice(t,1),0===this._g_handlers.length&&this._board.send(h.STOP_GYR);break;case a.MAGNETOMETER_MESSAGE:var t=this._m_handlers.indexOf(s);this._m_handlers.splice(t,1),0===this._m_handlers.length&&this._board.send(h.STOP_MAG);break;case a.ANGLE_MESSAGE:var t=this._o_handlers.indexOf(s);this._o_handlers.splice(t,1),0===this._o_handlers.length&&this._board.send(h.STOP_ANG);break;case a.AZIMUTH_MESSAGE:var t=this._c_handlers.indexOf(s);this._c_handlers.splice(t,1),0===this._c_handlers.length&&this._board.send(h.STOP_AZI);break;default:return!1}return!0}.bind(this),this._stopDetectAll=function(e){switch(e){case a.ACCELEROMETER_MESSAGE:this._a_handlers.length=0,this._board.send(h.STOP_ACC);break;case a.GYROSCOPE_MESSAGE:this._g_handlers.length=0,this._board.send(h.STOP_GYR);break;case a.MAGNETOMETER_MESSAGE:this._m_handlers.length=0,this._board.send(h.STOP_MAG);break;case a.ANGLE_MESSAGE:this._o_handlers.length=0,this._board.send(h.STOP_ANG);break;case a.AZIMUTH_MESSAGE:this._c_handlers.length=0,this._board.send(h.STOP_AZI);break;default:return!1}return!0}.bind(this),this._a_handlers=[],this._g_handlers=[],this._m_handlers=[],this._o_handlers=[],this._c_handlers=[]}n.prototype=s=Object.create(t.prototype,{constructor:{value:n},state:{get:function(){return this._state},set:function(e){this._state=e}},accVals:{get:function(){return this._accVals||[]}},gyrVals:{get:function(){return this._gyrVals||[]}},magVals:{get:function(){return this._magVals||[]}},angVals:{get:function(){return this._angVals||[]}},aziVals:{get:function(){return this._aziVals||[]}}}),s.on=function(e,s){if(2!==arguments.length)return!1;this._startDetect(e,s)&&"on"!==this._state&&(this._state="on",this._board.send(h.START_DETECT),this._board.on(_.SYSEX_MESSAGE,this._messageHandler))},s.off=function(e,s){!(1===arguments.length?this._stopDetectAll(e):this._stopDetect(e,s))||this._a_handlers.length||this._g_handlers.length||this._m_handlers.length||this._o_handlers.length||this._c_handlers.length||(this._state="off",this._board.send(h.STOP_DETECT),this._board.removeListener(_.SYSEX_MESSAGE,this._messageHandler))},s.setDetectTimeType=function(e){e!==this._detectTimeType&&(this._detectTimeType=e,this._board.send([240,4,96,1,e,247]))},e.module.MPU9250=n,e.module.MPU9250Event=a});