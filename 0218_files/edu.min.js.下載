!function(t){"undefined"==typeof exports?t(webduino||{}):module.exports=t}(function(t){"use strict";var e,s,n,i=t.Module,r=t.BoardEvent,o={STRING_ONCE:"string_once"};function a(t,s,n){i.call(this),this._board=t,(e=this)._pin=s,e._leds=n;var a="";n<=64?a=[240,4,33,0,n,s,247]:a=[240,4,33,4,n>>>6,63&n,s,247];t.send(a),t.on(r.SYSEX_MESSAGE,function(t){var s=t.message,n="";switch(s instanceof Array&&(n=s.join(",")),n){case"4,33,6":e.emit(o.STRING_ONCE)}})}a.prototype=s=Object.create(i.prototype,{constructor:{value:a},backlight:{get:function(){return n},set:function(t){n=t}}}),s.setColorByString=function(t,e){if(t>64)this.setColor64(t,e);else{var s="",n=[240,4,33,3];if(1==arguments.length)return s=t,void this.setColorByPiece(s);var i=e.substring(1,3),r=e.substring(3,5),o=e.substring(5,7),a=(parseInt(i,16)>>6&3)<<4|parseInt(r,16)>>4,h=(parseInt(i,16)>>4&3)<<4|parseInt(o,16)>>4;n.push(t),n.push(a),n.push(h),n.push(247),this._board.send(n),this._board.flush()}},s.setColorByPiece=function(t){var e=this;!function(t){var s=[240,4,33,3];s.push(64);for(var n=0;n<t.length;n+=8){t.substring(n,n+2);var i=t.substring(n+2,n+4),r=t.substring(n+4,n+6),o=t.substring(n+6,n+8),a=(parseInt(i,16)>>6&3)<<4|parseInt(r,16)>>4,h=(parseInt(i,16)>>4&3)<<4|parseInt(o,16)>>4;s.push(a),s.push(h)}s.push(247),e._board.send(s),e._board.flush()}(t)},s.setColor64=function(t,e){var s="",n=[240,4,33,5];n.push(t>>>6),n.push(63&t),s=s.concat(e.substring(1));for(var i=0;i<s.length;i++)n.push(s.charCodeAt(i));n.push(247),this._board.send(n),this._board.flush()},s.off=function(){this._board.send([240,4,33,2,247])},s.brightness=function(t){!function(t){var e=t.toString(16);parseInt(t)<16&&(e="0"+e)}(t);this._board.send([240,4,33,1,t,247]),this._board.flush()},s.setCharacter=function(t,e){var s="ABCDEFGHIJKLMNOPQRSTUVWXYZ!=~@abcdefghijklmnopqrstuvwxyz+/-*\",'<>.0123456789",n="",i=[240,4,33,4],r="";if(-1!=s.indexOf(t)&&(r=String(t),r=Array.from(r).shift()),-1!==s.indexOf(r)&&e){n=n.concat(e.substring(1));for(var o=0;o<n.length&&o<54;o++)i.push(n.charCodeAt(o));i.push(r.charCodeAt(0)),i.push(247),this._board.send(i),this._board.flush()}},s.setString=function(t,e,s){var n="",i=[240,4,33,5];n=n.concat(e.substring(1));for(var r=0;r<n.length;r++)i.push(n.charCodeAt(r));i.push(s),t=String(t);for(r=0;r<t.length&&r<54;r++)i.push(t.charCodeAt(r));i.push(247),this._board.send(i),this._board.flush()},s.setStringOnce=function(t,e,s,n){var i="",r=[240,4,33,6],a=this;n=n||function(){},i=i.concat(e.substring(1));for(var h=0;h<i.length;h++)r.push(i.charCodeAt(h));r.push(s),t=String(t);for(h=0;h<t.length&&h<54;h++)r.push(t.charCodeAt(h));return r.push(247),this._board.send(r),this._board.flush(),new Promise(function(t){a.once(o.STRING_ONCE,function(){n(),t()})})},s.setColor=function(t,e){if(2==arguments.length)(t=Math.round(t))>24?t=24:t<0&&(t=0),this.setColorByString(t,e);else{let e=t=>{let e=t;if(t.length<6)if(3==t.length){let t=e.split(""),s="";t.map(t=>{s=s+t+t}),e=s}else for(let s=0;s<6-t.length;s++)e+="0";else t.length>6&&(e=t.slice(0,6));return e},s=t=>{let s=[];for(let n=0;n<25;n++){let i;i=n<16?"0"+n.toString(16):n.toString(16),t.length>1?t[n]?s[n]=i+e(t[n]):s[n]=i+e("000000"):s[n]=i+e(t[0])}return s.join().replace(/,/g,"")},n=t=>{Array.isArray(t)&&(t=t.join());let e,n=t.replace(/\[|\]|\'|\"| |#|/g,"").split(",");return e=(e=n.length>1?s(n):200==n[0].length&&-1!=n[0].indexOf("0f")?n[0]:s(n)).slice(0,200)};this.setColorByString(n(t))}};var h=t.PinEvent,u=t.Pin,l=(i=t.Module,t.board.Bit),_={PRESS:"pressed",RELEASE:"released",LONG_PRESS:"longPress",SUSTAINED_PRESS:"sustainedPress"};function c(t,e,s,n){i.call(this),this._board=t,this._pin=e,this._repeatCount=0,this._timer=null,this._timeout=null,this._buttonMode=s||c.PULL_DOWN,this._sustainedPressInterval=n||1e3,this._debounceInterval=20,this._isUseDebounceInterval=!(t instanceof l&&[27,35].indexOf(e.number)>-1),this._pressHandler=function(){this.emit(_.PRESS),this._timer&&(clearInterval(this._timer),delete this._timer);this._timer=setInterval(this._sustainedPressHandler,this._sustainedPressInterval)}.bind(this),this._releaseHandler=function(){this.emit(_.RELEASE),this._timer&&(clearInterval(this._timer),delete this._timer);this._repeatCount=0}.bind(this),this._sustainedPressHandler=function(){this._repeatCount>0?this.emit(_.SUSTAINED_PRESS):this.emit(_.LONG_PRESS);this._repeatCount++}.bind(this),t.setDigitalPinMode(e.number,u.DIN),this._buttonMode===c.INTERNAL_PULL_UP?(t.enablePullUp(e.number),this._pin.value=u.HIGH):this._buttonMode===c.PULL_UP&&(this._pin.value=u.HIGH),this._pin.on(h.CHANGE,function(t){var e,s=t.value;this._buttonMode===c.PULL_DOWN?e=1===s?this._pressHandler:this._releaseHandler:this._buttonMode!==c.PULL_UP&&this._buttonMode!==c.INTERNAL_PULL_UP||(e=1===s?this._releaseHandler:this._pressHandler);this._isUseDebounceInterval?(this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(e,this._debounceInterval)):e()}.bind(this))}c.prototype=Object.create(i.prototype,{constructor:{value:c},buttonMode:{get:function(){return this._buttonMode}},sustainedPressInterval:{get:function(){return this._sustainedPressInterval},set:function(t){this._sustainedPressInterval=t}}}),c.PULL_DOWN=0,c.PULL_UP=1,c.INTERNAL_PULL_UP=2;var d={MESSAGE:"message"};function f(t,e){i.call(this),this._board=t,this._pinNumber=Number(e),this._messageHandler=function(t){var e=t.pin;if(this._pinNumber!==e.analogNumber)return!1;this.emit(d.MESSAGE,e.value)}.bind(this)}f.prototype=s=Object.create(i.prototype,{constructor:{value:f},state:{get:function(){return this._state},set:function(t){this._state=t}}}),s.measure=function(t){var e=this;this._board.enableAnalogPin(this._pinNumber),"function"!=typeof t&&(t=function(){}),this._callback=function(s){t(e.parserVal(s))},this._state="on",this._board.on(r.ANALOG_DATA,this._messageHandler),this.addListener(d.MESSAGE,this._callback)},s.off=function(){this._state="off",this._board.disableAnalogPin(this._pinNumber),this._board.removeListener(r.ANALOG_DATA,this._messageHandler),this.removeListener(d.MESSAGE,this._callback||function(){}),this._callback=null},s.parserVal=function(t){var e=298.15,s=3.3*t,n=5.1*(3.3-s)/s,i=3950*e/(3950+e*Math.log10(n/10))-273.15;return Math.round(100*i)/100},t.module.ButtonEvent=_,t.module.Button=c,t.module.Matrix=a,t.module.Thermistor=f});