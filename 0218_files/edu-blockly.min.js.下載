!function(t){"undefined"==typeof exports?t(window,window.webduino):module.exports=t}(function(t,e){"use strict";t.getMatrix=function(t,n,o){return new e.module.Matrix(t,n,o)},t.getButton=function(t,n){return new e.module.Button(t,t.getDigitalPin(n))},t.getMPU9250=function(t){return new e.module.MPU9250(t)},t.getPhotocell=function(t,n){return new e.module.Photocell(t,n)},t.getBuzzer=function(t,n){return new e.module.Buzzer(t,t.getDigitalPin(n))},t.getThermistor=function(t,n){return new e.module.Thermistor(t,n)},t.getPin=function(t,e){return t?t.getPin(e):void 0},t.Pin={},Pin.instances={},Pin.init=function(e,n,o){const i=`${e._options.device||e._options.url}_${n}_${o}`;return Pin.instances[i]||(Pin.instances[i]=getPin(e,t.bitGPIO(n)),Pin.instances[i].setMode(o)),Pin.instances[i]},t.textInput=function(){let t=document.getElementById("inputArea"),e=document.getElementById("input"),n=document.getElementById("send");return t.className="show",e.value="",e.focus(),new Promise(function(o){let i=()=>{window.thisInputVal=e.value,t.className="",n.removeEventListener("click",i),e.removeEventListener("change",i),o()};setTimeout(()=>{n.addEventListener("click",i),e.addEventListener("change",i)})})},t.keyboardEvent=function(){window.keyDownCode={},window.keyUpCode={},document.onkeydown=function(t){if(keyDownCode["code"+t.keyCode]){(0,keyDownCode["code"+t.keyCode])()}},document.onkeyup=function(t){keyUpCode["code"+t.keyCode]&&keyUpCode["code"+t.keyCode]()}},t.speakAsync=function(t,e){window.speechSynthesis.cancel();let n=new SpeechSynthesisUtterance(t);return n.lang=e[0],n.pitch=e[1],n.rate=e[2],window.speechSynthesis.speak(n),new Promise(e=>{n.onend=(()=>{console.log(t),e()})})},t._loop_={},t._delayTimer_={},t._startLoop_=(()=>{let t="abcdefghijklmnopqrstuvwxyz".split(""),e="$";for(let n=0;n<5;n++)e+=t[Math.floor(25*Math.random())];return e+=Math.floor(1e3*Math.random()),_loop_[e]=!0,e}),t._stopAllLoop_=(()=>{_loop_={};for(let t in _delayTimer_)clearTimeout(_delayTimer_[t]);_delayTimer_={}}),t.boardInit_=function(t,e,n){let o,i;switch(t._options.transport){case"mqtt":o="WiFi",i=t._options.device;break;case"message":o="Simulator",i="Simulator";break;case"websocket":o="USB",i="USB"}gtag("event",o,{event_category:"boardReady",event_label:i});let a={};return t.samplingInterval=e,t.sendingInterval=50,a._bit_matrix_=getMatrix(t,4,25),a._bit_btnA_=getPullupButton(t,35),a._bit_btnB_=getPullupButton(t,27),a._bit_buzzer_=getBuzzer(t,25),a._bit_buzzer_.buzzerPlaying_=!0,a._bit_pLeft_=getPhotocell(t,0),a._bit_pRight_=getPhotocell(t,3),a._bit_temp_=getThermistor(t,6),a._bit_mpu9250_=getMPU9250(t),a._bit_mpu9250_.setDetectTimeType(n),new Promise(t=>{t(a)})},t.detectInit_=function(t,n){return t._bit_detected_val_={temp:37.91,left:220,right:132},t._bit_mpu9250_val_={azi:0,row:0,pitch:0,yaw:0,accX:0,accY:0,accZ:0,gyrX:0,gyrY:0,gyrZ:0,magX:0,magY:0,magZ:0},n.temp&&t._bit_temp_.measure(function(e){t._bit_detected_val_.temp=Math.round(100*e)/100}),n.left&&t._bit_pLeft_.measure(function(e){t._bit_detected_val_.left=Math.round(1e3*e)}),n.right&&t._bit_pRight_.measure(function(e){t._bit_detected_val_.right=Math.round(1e3*e)}),n.azi&&t._bit_mpu9250_.on(e.module.MPU9250Event.AZIMUTH_MESSAGE,function(){t._bit_mpu9250_val_.azi=1*t._bit_mpu9250_.aziVals[0]}),n.acc&&t._bit_mpu9250_.on(e.module.MPU9250Event.ACCELEROMETER_MESSAGE,function(){t._bit_mpu9250_val_.accX=1*t._bit_mpu9250_.accVals[0],t._bit_mpu9250_val_.accY=1*t._bit_mpu9250_.accVals[1],t._bit_mpu9250_val_.accZ=1*t._bit_mpu9250_.accVals[2]}),n.gyr&&t._bit_mpu9250_.on(e.module.MPU9250Event.GYROSCOPE_MESSAGE,function(){t._bit_mpu9250_val_.gyrX=1*t._bit_mpu9250_.gyrVals[0],t._bit_mpu9250_val_.gyrY=1*t._bit_mpu9250_.gyrVals[1],t._bit_mpu9250_val_.gyrZ=1*t._bit_mpu9250_.gyrVals[2]}),n.mag&&t._bit_mpu9250_.on(e.module.MPU9250Event.MAGNETOMETER_MESSAGE,function(){t._bit_mpu9250_val_.magX=1*t._bit_mpu9250_.magVals[0],t._bit_mpu9250_val_.magY=1*t._bit_mpu9250_.magVals[1],t._bit_mpu9250_val_.magZ=1*t._bit_mpu9250_.magVals[2]}),n.ang&&t._bit_mpu9250_.on(e.module.MPU9250Event.ANGLE_MESSAGE,function(){t._bit_mpu9250_val_.row=1*t._bit_mpu9250_.angVals[0],t._bit_mpu9250_val_.pitch=1*t._bit_mpu9250_.angVals[1],t._bit_mpu9250_val_.yaw=1*t._bit_mpu9250_.angVals[2]}),new Promise(t=>{setTimeout(t,500)})},t.buzzer_music=function(t){let e={notes:[],tempos:[]};if(t[0].notes.length>1)for(var n=0;n<t.length;n++){if(Array.isArray(t[n].notes)){let o=e.notes.concat(t[n].notes);e.notes=o}else e.notes.push(t[n].notes);if(Array.isArray(t[n].tempos)){let o=e.tempos.concat(t[n].tempos);e.tempos=o}else e.tempos.push(t[n].tempos)}else e.notes=[t[0].notes],e.tempos=[t[0].tempos];return e},t.buzzerPlay_=async function(t,e,n){let o=e,i=n;if(Array.isArray(o[0])&&(o=o[0]).forEach((t,e)=>{null==t&&(o[e]="0")}),Array.isArray(i[0])&&(i=i[0]).forEach((t,e)=>{null==t&&(i[e]=2)}),0==o.length&&(o=["0"]),0==i.length&&(i=[2]),o.length>i.length){let t=i.length,e=o.length-i.length,n=i[i.length-1];for(let o=0;o<e;o++)i[t+o]=n}if(o.length<i.length){let t=o.length,e=i.length-o.length,n=o[o.length-1];for(let i=0;i<e;i++)o[t+i]=n}if(t._bit_buzzer_.buzzerPlaying_){t._bit_buzzer_.buzzerThis={};let e="t"+(new Date).getTime();t._bit_buzzer_.buzzerThis[e]=!0,t._bit_buzzer_.play(o,i);let n=function(t){return new Promise(e=>{setTimeout(e,t)})};for(;t._bit_buzzer_.buzzerPlaying_&&t._bit_buzzer_.buzzerThis[e]&&"stopped"!=t._bit_buzzer_._state&&"stop"!=t._bit_buzzer_._state;)await n(10);return new Promise(t=>{t()})}},t.buzzerPlayEvent_=function(t,e){switch(e){case"stop":t._bit_buzzer_.buzzerPlaying_=!1,t._bit_buzzer_.stop(),setTimeout(function(){t._bit_buzzer_.buzzerPlaying_=!0},50);break;case"pause":t._bit_buzzer_.pause();break;case"play":t._bit_buzzer_.play()}},t.mpu9250Fn_={},mpu9250Fn_.shake=async function(t,e){t.shakeStop=!1;let n=function(e){return Math.abs(t._bit_mpu9250_val_.gyrX)+Math.abs(t._bit_mpu9250_val_.gyrY)+Math.abs(t._bit_mpu9250_val_.gyrZ)>90?t.shakeStop||(t.shakeStop=!0,e()):t.shakeStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await n(e)},mpu9250Fn_.peace=async function(t,e){t.peaceStop=!1;let n=function(e){return Math.abs(t._bit_mpu9250_val_.gyrX)+Math.abs(t._bit_mpu9250_val_.gyrY)+Math.abs(t._bit_mpu9250_val_.gyrZ)<=90?t.peaceStop||(t.peaceStop=!0,e()):t.peaceStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await n(e)},mpu9250Fn_.rowForward=async function(t,e){t.rowForwardStop=!1;let n=function(e){return t._bit_mpu9250_val_.row>=-150&&t._bit_mpu9250_val_.row<=-100&&!t.pitchRightStop&&!t.pitchLeftStop?t.rowForwardStop||(t.rowForwardStop=!0,e()):t.rowForwardStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await n(e)},mpu9250Fn_.rowBack=async function(t,e){t.rowBackStop=!1;let n=function(e){return t._bit_mpu9250_val_.row>=100&&t._bit_mpu9250_val_.row<=150&&!t.pitchRightStop&&!t.pitchLeftStop?t.rowBackStop||(t.rowBackStop=!0,e()):t.rowBackStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await n(e)},mpu9250Fn_.pitchLeft=async function(t,e){t.pitchLeftStop=!1;let n=function(e){return t._bit_mpu9250_val_.pitch>=30&&!t.rowBackStop&&!t.rowForwardStop?t.pitchLeftStop||(t.pitchLeftStop=!0,e()):t.pitchLeftStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await n(e)},mpu9250Fn_.pitchRight=async function(t,e){t.pitchRightStop=!1;let n=function(e){return t._bit_mpu9250_val_.pitch<=-30&&!t.rowBackStop&&!t.rowForwardStop?t.pitchRightStop||(t.pitchRightStop=!0,e()):t.pitchRightStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await n(e)},mpu9250Fn_.turnLeft=mpu9250Fn_.pitchLeft,mpu9250Fn_.turnRight=mpu9250Fn_.pitchRight,mpu9250Fn_.faceFront=async function(t,e){t.faceFrontStop=!1;let n=function(e){return!(t._bit_mpu9250_val_.accZ<=-30)||t.rowBackStop||t.rowForwardStop||t.pitchRightStop||t.pitchLeftStop?t.faceFrontStop=!1:t.faceFrontStop||(t.faceFrontStop=!0,e()),new Promise(t=>{setTimeout(t,100)})};for(;;)await n(e)},mpu9250Fn_.faceBack=async function(t,e){t.faceBackStop=!1;let n=function(e){return t._bit_mpu9250_val_.accZ>=30?t.faceBackStop||(t.faceBackStop=!0,e()):t.faceBackStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await n(e)},mpu9250Fn_.faceNorth=async function(t,e){t.faceNorthStop=!1;let n=function(e){let n=t._bit_mpu9250_val_.azi;return n<0&&(n+=360),n>=0&&n<=30||n>=330&&n<=360?t.faceNorthStop||(t.faceNorthStop=!0,e()):t.faceNorthStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await n(e)},mpu9250Fn_.faceEast=async function(t,e){t.faceEastStop=!1;let n=function(e){let n=t._bit_mpu9250_val_.azi;return n<0&&(n+=360),n>=60&&n<=120?t.faceEastStop||(t.faceEastStop=!0,e()):t.faceEastStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await n(e)},mpu9250Fn_.faceSouth=async function(t,e){t.faceSouthStop=!1;let n=function(e){let n=t._bit_mpu9250_val_.azi;return n<0&&(n+=360),n>=150&&n<=210?t.faceSouthStop||(t.faceSouthStop=!0,e()):t.faceSouthStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await n(e)},mpu9250Fn_.faceWest=async function(t,e){t.faceWestStop=!1;let n=function(e){let n=t._bit_mpu9250_val_.azi;return n<0&&(n+=360),n>=240&&n<=300?t.faceWestStop||(t.faceWestStop=!0,e()):t.faceWestStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await n(e)},t.emojiList_=["0000001010000001000101110","0000001010000000111010001","1000101010001001101111011","0111011111111110111001110","1010101110111110111010101","0000001010011100010000000","0101011111111110111000100","0101010101100010101000100","0000000100011101111100000","0000011111011100010000000","0001000110011100011000010","0100001100011100110001000","0000000001000110011101111","0000010000110001110011110","0111100111000110000100000","1111011100110001000000000","0010001110101010010000100","0010000100101010111000100","0010001000111110100000100","0010000010111110001000100","1110011000101000001000001","0011100011001010100010000","0000100010101001100011100","1000001000001010001100111","1000111011111111101110001","1111101110001000111011111","1000111010111001101010001","1000101011001110101110001","0000000000001000000000000","0000000100000000010000000","0000000100000000101000000","0000001010000000101000000","0000001010001000101000000","0101000000010100000001010","0000001110010100111000000","0000001110011100111000000","0111010001100011000101110","0010001110111110111000100","0010001010100010101000100","1111110001101011000111111","1111110101111111010111111","0010001010101010101000100","0010010101011100101010001","0000100010101000100000000","0011000101001001110011100","0111101001010011101111011","0101011111010101111101010","0111101111011110100001000","1111111011101011101111111","0111001110001001111100100","0010100010111011010011100","1010101010101010101010101","0010010110111111011000100","1010110101111111000111111","1111100000111110000011111","0000011111000001111100000","0010000100111110010000100","0000000000111110000000000","1000101010001000101010001","0010000000111110000000100"],t.matrixEmoji_=function(t,e){let n,o,i="";return o=e.replace("#",""),(n=t.split("")).forEach((t,e)=>{let n=e.toString(16);parseInt(e)<16&&(n="0"+n),i+=t=t<1?n+"000000":n+o}),i},t.btnEvent_=function(t,e,n,o){let i={pressed:[],released:[],longPress:[]};return["pressed","released","longPress"].forEach(t=>{o.forEach(e=>{e.on(t,function(){e.statusRec=e.statusRec||{},e.statusRec[t]=Date.now(),function(t,e){let n=i[t].filter(t=>t.target===e);0!==n.length&&setTimeout((t,e)=>{let i=o.filter(t=>t!==e),a=e.statusRec[t];i.every(e=>e.statusRec&&e.statusRec[t]&&Math.abs(a-e.statusRec[t])<100)||n.forEach(t=>t.fn())},100,t,e)}(t,e)})})}),i[e].push({target:t,fn:n}),function(t,e,n){i[e].push({target:t,fn:n})}},t.btnsEvent_=function(t,e,n){let o={pressed:[],released:[],longPress:[]};return["pressed","released","longPress"].forEach(t=>{n.forEach(e=>{e.on(t,function(){var i;e.statusRec=e.statusRec||{},e.statusRec[t]=Date.now(),i=t,n.every(t=>t.statusRec&&Math.abs(Date.now()-t.statusRec[i])<100)&&setTimeout(function(){o[i].forEach(t=>t())},100)})})}),o[t].push(e),function(t,e){o[t].push(e)}},t.speechValue_="",t.speechRecognition=function(t){return new Promise(e=>{let n=new webkitSpeechRecognition,o=0;n.continuous=!0,n.interimResults=!0,n.lang=t,n.onstart=function(){o=1,console.log("開始辨識...")},n.onend=function(){console.log("停止辨識!"),o>0&&n.start()},n.onresult=function(t){speechValue_=t.results[0][0].transcript,setTimeout(()=>{o=0,n.stop(),e()},2e3)},n.start()})}});